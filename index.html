<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Puzzle Game</title>
<link rel="stylesheet" href="style.css" />
<style>
  body { margin:0; font-family:Arial,sans-serif; text-align:center; background:#f5f5f5; }
  .title { margin:1em; font-size:2em; }
  #player-form, #player-info, #score-panel, #puzzle-board, #next-button, #ad-space { margin:1em auto; }
  #puzzle-board { display:grid; grid-template:repeat(3,100px)/repeat(3,100px); gap:2px; width:306px; }
  .piece { width:100px; height:100px; background-size:300px 300px; cursor:pointer; border:1px solid #ccc; }
  .selected { outline:3px solid #4CAF50; }
  #next-button, #start-button { padding:0.5em 1em; font-size:1em; cursor:pointer; background:#4CAF50; color:#fff; border:none; border-radius:5px; }
  #ad-space img { width:200px; }
</style>
</head>
<body>
  <h1 class="title">üß© PUZZLE GAME </h1>
  <div id="player-form">
    <input id="player-name" placeholder="Entrez votre nom" />
    <button id="start-button">Commencer</button>
  </div>
  <div id="player-info" style="display:none;"></div>
  <div id="score-panel" style="display:none;">‚è± Temps : <span id="timer">0</span>s | Coups : <span id="moves">0</span></div>
  <div id="puzzle-board"></div>
  <button id="next-button" style="display:none;">‚û° Rejouer</button>
  <div id="ad-space"><img src="Files/ad.jpg" alt="Pub" /><p>Visitez notre ferme bio‚ÄØ!</p></div>

<script>
  let moves=0, seconds=0, timerInterval;
  const gridSize=3, pieceSize=100;
  const board = document.getElementById('puzzle-board');

  document.getElementById('start-button').onclick = () => {
    const name = document.getElementById('player-name').value.trim() || "Joueur";
    document.getElementById('player-form').style.display='none';
    document.getElementById('player-info').textContent=`üë§ ${name}`; document.getElementById('player-info').style.display='block';
    document.getElementById('score-panel').style.display='block';
    timerInterval = setInterval(() => { seconds++; document.getElementById('timer').textContent=seconds; },1000);
    initBoard();
  };

  function initBoard(){
    moves=0; seconds=0;
    document.getElementById('moves').textContent=0;
    board.innerHTML='';
    const positions=[...Array(gridSize*gridSize).keys()].sort(()=>Math.random()-0.5);
    positions.forEach((pos,i)=> {
      const piece = document.createElement('div');
      piece.className='piece';
      const x = (pos%gridSize)*-pieceSize;
      const y = Math.floor(pos/gridSize)*-pieceSize;
      piece.style.backgroundImage="url('Files/cat.jpg')";
      piece.style.backgroundPosition=`${x}px ${y}px`;
      piece.dataset.pos = pos;
      piece.onclick = () => handleClick(piece);
      board.appendChild(piece);
    });
  }

  let selected=null;
  function handleClick(piece){
    if(selected===null){ selected=piece; piece.classList.add('selected'); }
    else if(selected!==piece){
      const tmp=selected.style.backgroundPosition;
      selected.style.backgroundPosition = piece.style.backgroundPosition;
      piece.style.backgroundPosition = tmp;
      selected.classList.remove('selected');
      selected=null;
      moves++; document.getElementById('moves').textContent=moves;
      checkWin();
    }
  }

  function checkWin(){
    const ok = [...board.children].every((p,i)=>{
      const x = (i%gridSize)*-pieceSize;
      const y = Math.floor(i/gridSize)*-pieceSize;
      return p.style.backgroundPosition === `${x}px ${y}px`;
    });
    if(ok){ clearInterval(timerInterval); setTimeout(win,200); }
  }

  function win(){
    board.style.transform='scale(1.2)';
    setTimeout(()=>{
      alert('üéâ Bien jou√© !');
      document.getElementById('next-button').style.display='inline-block';
    },500);
  }

  document.getElementById('next-button').onclick = () => {
    board.style.transform='scale(1)';
    document.getElementById('next-button').style.display='none';
    initBoard();
    seconds=0; moves=0; document.getElementById('timer').textContent=0;
    timerInterval = setInterval(() => { seconds++; document.getElementById('timer').textContent=seconds; },1000);
  };
</script>
</body>
</html>
